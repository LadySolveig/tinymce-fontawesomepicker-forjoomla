!function(){"use strict";function e(e){e.ui.registry.addIcon(t,r),e.ui.registry.addButton(t,{icon:t,tooltip:t,onAction:function(){e.execCommand("mceOpenFontawesomepicker")}}),e.ui.registry.addMenuItem(t,{icon:t,text:t,onAction:function(){e.execCommand("mceOpenFontawesomepicker")}}),e.ui.registry.addMenuItem("fontawesomesetting",{icon:"preferences",text:"Icon setting",onAction:function(){c(e)}}),e.ui.registry.addContextMenu("fontawesomesetting",{update:function(e){var t=e.classList;return t.contains("mark-fapk")||t.contains("mark-fapkw")?"fontawesomesetting":""}})}var t="fontawesomepicker",n="fontawesomepickerCallback",o=tinymce.util.Tools.resolve("tinymce.PluginManager"),a={},i={loadStyle:function(e,t){if(!e.querySelector('link[href*="'+t+'"]')){var n=e.createElement("link");n.href=t,n.rel="stylesheet",e.head.appendChild(n)}},unique:function(e){var t=e.reduce(function(e,t){return e[t]=1,e},{});return Object.keys(t)},getRngNode:function(e){var t=e.selection.getRng(),n=t.startContainer;return 1!==n.nodeType&&(n=n.parentNode),n},jsonp:function(e,t,n){a[e]=a[e]||{};var o=a[e];if(!o.status&&!o.script){var i=document.createElement("script");i.src=e,document.head.appendChild(i),o.status=0,o.script=i,window[t]=function(e){o.status=1,o.data=e},o.script.onload=o.script.onerror=function(){delete window[t],delete o.script,this.parentNode&&this.parentNode.removeChild(this)}}!o.status&&o.script&&o.script.addEventListener("load",function(){n(o.data)}),o.status&&n(o.data)},getmatrix:function(e){var t=Math.round(180*Math.asin(e[0])/Math.PI),n=Math.round(180*Math.acos(e[1])/Math.PI),o=Math.round(180*Math.asin(e[2])/Math.PI),a=Math.round(180*Math.acos(e[3])/Math.PI),i=0;return t==n||-t==n?i=a:-t+n==180?i=180+o:t+n==180&&(i=360-o||360-a),i>=360?0:i}},c=function(e){var t=i.getRngNode(e),n=e.$(t).children(".mark-fapk")[0],o=e.$(n).css("transform").replace(/(matrix|none|\(|\))/g,"");o=i.getmatrix(o.split(",").map(parseFloat)),e.windowManager.open({title:"Icon setting",body:{type:"panel",items:[{type:"selectbox",name:"icon-style",label:"Style",items:[{value:"none",text:"None"},{value:"rounded",text:"Circle"},{value:"boxed",text:"Square"},{value:"rounded-less",text:"Rounded"},{value:"rounded-outline",text:"Outline Circle"},{value:"boxed-outline",text:"Outline Square"},{value:"rounded-less-outline",text:"Outline Rounded"}]},{type:"input",name:"icon-size",label:"Icon size"},{type:"colorinput",name:"icon-color",label:"Icon color"},{type:"input",name:"icon-rotate",label:"Rotation angle (0deg)"},{type:"colorinput",name:"style-color",label:"Style color"}]},buttons:[{type:"cancel",name:"closeButton",text:"Cancel"},{type:"submit",name:"submitButton",text:"Change",primary:!0}],initialData:{"icon-style":e.$(t).attr("icon-style")||"none","icon-size":e.$(n).css("font-size"),"icon-color":e.$(n).css("color")||"","icon-rotate":o+"deg","style-color":e.$(t).attr("style-color")||""},onSubmit:function(o){var a=o.getData(),i={"font-size":a["icon-size"],color:a["icon-color"]};if(n.removeAttribute("style"),[0,"0","0deg"].includes(a["icon-rotate"])||(i.display="inline-block",i.transform="rotate("+a["icon-rotate"]+")",i["-ms-transform"]="rotate("+a["icon-rotate"]+")",i["-moz-transform"]="rotate("+a["icon-rotate"]+")",i["-webkit-transform"]="rotate("+a["icon-rotate"]+")",i["-o-transform"]="rotate("+a["icon-rotate"]+")"),"none"===a["icon-style"])t.removeAttribute("icon-style"),t.removeAttribute("style-color");else switch(e.$(t).attr("icon-style",a["icon-style"]),e.$(t).attr("style-color",a["style-color"]),i.display="inline-block",i["text-align"]="center",i.width=i.height=i["line-height"]="1.4em",a["icon-style"]){case"rounded":i["border-radius"]="50%",i["background-color"]=a["style-color"];break;case"boxed":i["background-color"]=a["style-color"];break;case"rounded-less":i["border-radius"]="5px",i["background-color"]=a["style-color"];break;case"rounded-outline":i["border-radius"]="50%",i.border="2px solid "+a["style-color"];break;case"boxed-outline":i.border="2px solid "+a["style-color"];break;case"rounded-less-outline":i["border-radius"]="5px",i.border="2px solid "+a["style-color"]}e.$(n).css(i),o.close()}})},r='<svg width="24" height="24" viewBox="0 0 512 512"><path d="M116.65 219.35a15.68 15.68 0 0 0 22.65 0l96.75-99.83c28.15-29 26.5-77.1-4.91-103.88C203.75-7.7 163-3.5 137.86 22.44L128 32.58l-9.85-10.14C93.05-3.5 52.25-7.7 24.86 15.64c-31.41 26.78-33 74.85-5 103.88zm143.92 100.49h-48l-7.08-14.24a27.39 27.39 0 0 0-25.66-17.78h-71.71a27.39 27.39 0 0 0-25.66 17.78l-7 14.24h-48A27.45 27.45 0 0 0 0 347.3v137.25A27.44 27.44 0 0 0 27.43 512h233.14A27.45 27.45 0 0 0 288 484.55V347.3a27.45 27.45 0 0 0-27.43-27.46zM144 468a52 52 0 1 1 52-52 52 52 0 0 1-52 52zm355.4-115.9h-60.58l22.36-50.75c2.1-6.65-3.93-13.21-12.18-13.21h-75.59c-6.3 0-11.66 3.9-12.5 9.1l-16.8 106.93c-1 6.3 4.88 11.89 12.5 11.89h62.31l-24.2 83c-1.89 6.65 4.2 12.9 12.23 12.9a13.26 13.26 0 0 0 10.92-5.25l92.4-138.91c4.88-6.91-1.16-15.7-10.87-15.7zM478.08.33L329.51 23.17C314.87 25.42 304 38.92 304 54.83V161.6a83.25 83.25 0 0 0-16-1.7c-35.35 0-64 21.48-64 48s28.65 48 64 48c35.2 0 63.73-21.32 64-47.66V99.66l112-17.22v47.18a83.25 83.25 0 0 0-16-1.7c-35.35 0-64 21.48-64 48s28.65 48 64 48c35.2 0 63.73-21.32 64-47.66V32c0-19.48-16-34.42-33.92-31.67z"/></svg>',s=function(){function e(e,n){var o=e.getParam("fontawesomeUrl");i.loadStyle(document,o),i.loadStyle(document,n+"/asset/style.css"),i.loadStyle(e.contentDocument,o),a.all||t(n)}function t(e){i.jsonp(e+"/asset/categories.js",n,function(e){o(e)})}function o(e){a.all={icons:[],label:"all"};for(var t in e)a.all.icons=a.all.icons.concat(e[t].icons),a[t]=e[t];a.all.icons=i.unique(a.all.icons)}var a={},c="";return function(t,n){return t.on("init",e.bind(null,t,n)),{editor:t,open:function(){t.windowManager.open({title:"Icons",size:"large",body:{type:"panel",items:[{type:"htmlpanel",html:this.renderBody()}]},buttons:[{type:"cancel",name:"close",text:"Close",primary:!0}]}),this.openAfter()},openAfter:function(){var e=this;e.changeNav("all"),t.$(".mce-fontawesomepicker--nav__item",document).off("click").on("click",function(){var t=this.getAttribute("title");e.changeNav(t)}),t.$(".mce-fontawesomepicker--icon",document).off("click").on("click",function(){var t=this.getAttribute("title");e.insertIcon(t)})},renderNav:function(){var e="";e+='<div class="mce-fontawesomepicker--nav">';for(var t in a){e+='<div class="mce-fontawesomepicker--nav__item" title="'+t+'">'+a[t].label+"</div>"}return e+="</div>"},renderIcons:function(){var e=this,t="";return t+='<div class="mce-fontawesomepicker--icons">',t+=a.all.icons.reduce(function(t,n){var o=e.toIconClass(n);return t+='<div class="mce-fontawesomepicker--icon" title="'+n+'">',t+='\t<span><i class="'+o+'"></i></span>',t+="\t<span>"+n+"</span>",t+="</div>"},""),t+="</div>"},renderBody:function(){return c||(c+='<div class="mce-fontawesomepicker--body">',c+='\t<div class="mce-fontawesomepicker--aside">',c+=this.renderNav(),c+="\t</div>",c+='\t<div class="mce-fontawesomepicker--content">',c+=this.renderIcons(),c+="\t</div>",c+="</div>")},toIconClass:function(e){var t=e.split("-")[0];return e.replace(t,t+" fa")},showIcons:function(e){var n=a[e];n&&t.$(".mce-fontawesomepicker--icon",document).each(function(e){var t=this.getAttribute("title");this.style.display=n.icons.includes(t)?"block":"none"})},changeNav:function(e){var t=document.querySelector(".mce-fontawesomepicker--nav__item.current"),n=document.querySelector('.mce-fontawesomepicker--nav__item[title="'+e+'"]');t&&t.classList.remove("current"),n&&n.classList.add("current"),this.showIcons(e)},insertIcon:function(e){var n=this.toIconClass(e),o=' <span class="mark-fapkw">\x3c!-- . --\x3e<span contenteditable="false" class="mark-fapk '+n+'"></span></span> ';t.execCommand("mceInsertContent",!1,o),t.windowManager.close()}}}}();!function(){o.add(t,function(t,n){var o=s(t,n);return t.settings.extended_valid_elements=t.settings.extended_valid_elements||"",t.settings.extended_valid_elements+=",span[*]",t.settings.contextmenu=t.settings.contextmenu||"",t.settings.contextmenu+=" fontawesomesetting",t.addCommand("mceOpenFontawesomepicker",function(){o.open()}),e(t),{}})}()}();